---
layout: post
title: Freescale智能车校赛
category: coding
description: 
---

# 0x00 废话
智能车校赛已经结束了很久了，抽个时间记录一下，为了这辆车也付出了很多，不知道通了几次宵，熬夜次数就更记不清了，最后拿到了校三等奖。感觉我们的程序是有机会拿到二等奖的，在最后决赛的那天，我们上场前调程序时就感觉车的状态不太对，调了几个参数也没有改变，当时也没有想到是车上零件松了，最后没能跑完全程。大概还是需要一些运气的吧，可能我们的运气不是很好，或许资格赛前一天晚上现场试车编码器突然坏掉错过试车就是一个暗示？

# 0x01 硬件
- B车车模（辣鸡！抓地力超级差）
- k60
- 蓝宙CCD
- 龙邱摄像头
- 龙邱编码器

# 0x02 软件
- 赛道识别
一开始我们用的是CCD，在标准赛道效果还不错，中期结束后校队表示地面蓝布的维护成本太大，所以撤去了蓝布，实验室地面反光、光线不均匀以及其他队伍的影子等等使环境变得很差，而CCD采样数据过少，仅仅一行128个像素点，很容易受到这些因素的干扰，我们还尝试过OSTU（最大类间差法）通过动态阈值降低这些干扰，但效果并不理想。因此，我们又更换了摄像头做为传感器，减少个别区域对整体的影响（实际还是会有误判），使用校队的寻线算法，基本原理就是检测赛道的黑白跳变，判断边线。

- 舵机控制
舵机方面我们采用了分级控制，通过有效边线行数来确定修正的紧急程度，通过设定不同的Kp和Kd来控制舵机的响应速度，因为不需要对未来进行预测，所以仅使用了PD算法。

- 速度控制
速度通过编码器获取小车实际速度，通过PD控制电机pwm占空比，为防止小车出现瞬时误判急加速，我们对占空比的上限做了一定限制。

# 0x03 总结
虽然都说这个比赛是性价比最低的比赛，但如果真的想要去做，想要学到一些东西，而不仅仅是为了学分。由于中途更换传感器，我们的时间也有一点紧张，设计出的算法也不尽如人意，PID参数的整定也没有完全完成，对于赛道的模式识别也只做了一些重要的部分，这些都是我们还可以提升的地方。明年再战？