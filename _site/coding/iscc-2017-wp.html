<!DOCTYPE html>
<html>
<head>
    <!--
    * Author:         Raphael__
    -->
    <meta charset="utf-8" />
    <title>ISCC2017 WriteUp | Raphael's Blog</title>
    <meta name="author" content="Raphael" />
    <meta name="renderer" content="webkit">
    <meta name="description" content="Raphael's Blog" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="/css/default.css" type="text/css" />
    <link rel="stylesheet" href="/css/pygments.css" type="text/css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <script src="/js/jquery-1.7.1.min.js" type="text/javascript"></script>
</head>
<body>

    <div class="home-menu">
        <div class="home-icon-con">
            <a class="home-menu-icon" href="/">Raphael</a>
            <a class="home-follow" href="#" title="Contact Me">+</a>
        </div>
    </div>

    <style type="text/css">
    body { background:#e8e8e8; }
    @media screen and (max-width: 750px){
        body { background:#fff; }
    }
    @media screen and (max-width: 1020px){
        body { background:#fff; }
    }
</style>

<div id="content">
    <div class="entry">
        <h1 class="entry-title"><a href="/coding/iscc-2017-wp" title="ISCC2017 WriteUp">ISCC2017 WriteUp</a></h1>
        <p class="entry-date">2017-06-24</p>
        <h2 id="0x00-basic-01">0x00 Basic-01</h2>

<p>题目：身为二战时期的密码专家，你截获了通信员身上的一段密文、密钥序列和加密列表。你能看懂吗？</p>

<p><img src="/images/iscc-2017-wp/1.jpg" alt="题目文件" /></p>

<p>根据题目描述和加密表的形式推测加密方式为轮盘加密，密钥则是轮盘的正确顺序，正确加密表如图：</p>

<p><img src="/images/iscc-2017-wp/2.jpg" alt="还原后的加密表" /></p>

<p>写脚本爆破，得出flag：FIREINTHEHOLE</p>

<p>附：脚本代码</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="lineno"> 1 </span><span class="n">a</span> <span class="o">=</span><span class="s2">&quot;&quot;&quot;NACZDTRXMJQOYHGVSFUWIKPBEL</span>
<span class="lineno"> 2 </span><span class="s2">FHTEQGYXPLOCKBDMAIZVRNSJUW</span>
<span class="lineno"> 3 </span><span class="s2">QGWTHSPYBXIZULVKMRAFDCEONJ</span>
<span class="lineno"> 4 </span><span class="s2">KCPMNZQWXYIHFRLABEUOTSGJVD</span>
<span class="lineno"> 5 </span><span class="s2">SXCDERFVBGTYHNUMKILOPJZQAW</span>
<span class="lineno"> 6 </span><span class="s2">EIURYTASBKJDFHGLVNCMXZPQOW</span>
<span class="lineno"> 7 </span><span class="s2">VUBMCQWAOIKZGJXPLTDSRFHENY</span>
<span class="lineno"> 8 </span><span class="s2">OSFEZWAXJGDLUBVIQHKYPNTCRM</span>
<span class="lineno"> 9 </span><span class="s2">QNOZUTWDCVRJLXKISEFAPMYGHB</span>
<span class="lineno">10 </span><span class="s2">OWTGVRSCZQKELMXYIHPUDNAJFB</span>
<span class="lineno">11 </span><span class="s2">FCUKTEBSXQYIZMJWAORPLNDVHG</span>
<span class="lineno">12 </span><span class="s2">NBVCXZQWERTPOIUYALSKDJFHGM</span>
<span class="lineno">13 </span><span class="s2">PNYCJBFZDRUSLOQXVETAMKGHIW&quot;&quot;&quot;</span>
<span class="lineno">14 </span><span class="n">b</span><span class="o">=</span><span class="s2">&quot;NFQKSEVOQOFNP&quot;</span>
<span class="lineno">15 </span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
<span class="lineno">16 </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">26</span><span class="p">):</span>
<span class="lineno">17 </span>	<span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="lineno">18 </span>	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
<span class="lineno">19 </span>		<span class="n">s</span><span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
<span class="lineno">20 </span>	<span class="k">print</span> <span class="n">s</span>
<span class="lineno">21 </span>	<span class="k">print</span> <span class="s2">&quot;&quot;</span></code></pre></figure>

<h2 id="0x01-basic-02">0x01 Basic-02</h2>

<p>题目：简单加密</p>

<p>636A56355279427363446C4A49454A7154534230526D6843
56445A31614342354E326C4B4946467A5769426961453067</p>

<p>看到题目之后的第一感觉是Base64编码，解码得到</p>

<blockquote>
  <p>cjV5RyBscDlJIEJqTSB0RmhC</p>
</blockquote>

<blockquote>
  <p>VDZ1aCB5N2lKIFFzWiBiaE0g</p>
</blockquote>

<p>再次解码得到</p>

<blockquote>
  <p>r5yG lp9I BjM tFhB</p>
</blockquote>

<blockquote>
  <p>T6uh y7iJ QsZ bhM</p>
</blockquote>

<p>最后一步脑洞比较大，问了一位喜欢密码学的同学。得到答案，对照键盘，圈字母。 #= =</p>

<p>flag：TONGYUAN</p>

<h2 id="0x02-basic-03">0x02 Basic-03</h2>

<p>题目：小明最近参加一个叫共济会的社团，社长一天神秘失踪，在社长电脑桌面上同学们发现一张奇怪的照片，为找到社长，社员们正在努力解密这张照片如图所示，可是一直找不到答案，你们发现神秘蛛丝马迹吗?</p>

<p><img src="/images/iscc-2017-wp/3.png" alt="题目文件" /></p>

<p>图片隐写，先在kali下用binwalk查看是否含有其他内容</p>

<p><img src="/images/iscc-2017-wp/5.jpg" alt="kali shell" /></p>

<p>发现文件末尾包含另一个图片文件，用foremost分离得到</p>

<p><img src="/images/iscc-2017-wp/4.png" alt="分离结果" /></p>

<p>百度猪圈密码，flag：goodluck</p>

<h2 id="0x03-basic-04">0x03 Basic-04</h2>

<p>题目：我们刚刚拦截了敌军的文件传输获取一份机密文件，请君速速破解。</p>

<p><img src="/images/iscc-2017-wp/6.jpg" alt="文件内容" /></p>

<p>题目文件解压后是一个文本文档，内容如上图，字符串开头504B，发现是zip的文件头，以二进制方式写入文件，发现是一个有密码的压缩文件，直接爆破，密码为123456</p>

<p>成功解压后内部是一个文本文档，flag：daczcasdqwdcsdzasd</p>

<h2 id="0x04-basic-07">0x04 Basic-07</h2>

<p>题目：这是一个二维码</p>

<p><img src="/images/iscc-2017-wp/7.png" alt="u5bc6u7801u7eafu6570u5b57u5171u0038u4f4d.png" /></p>

<p>扫描这个二维码结果：The password of the router is our flag</p>

<p>把他丢到kali下检测一下</p>

<p><img src="/images/iscc-2017-wp/8.jpg" alt="分离结果" /></p>

<p>分离出一个压缩包，其中有一个网络流量抓包文件和一个文本文件，爆破压缩包密码:20161114</p>

<p>打开cap文件，发现是wifi流量记录，包含一个完整握手过程</p>

<p><img src="/images/iscc-2017-wp/9.jpg" alt="cap文件" /></p>

<p>根据提示是ISCC+四位数字字母，生成字典用aircrack-ng跑密码，得到flag：ISCC16BA</p>

<h2 id="0x05-basic-08">0x05 Basic-08</h2>

<p>题目：小明的U盘中毒了。病毒把小明的文档压缩并加密。现在小明忘了公邮密码，然而记录密码的文档却被病毒压缩并加密，你能帮助小明解开吗？</p>

<p>题目文件包括一个压缩包和一个文本文件，爆破压缩包密码：BIT</p>

<p>解压后发现文本文件中字符串为Base64编码</p>

<blockquote>
  <p>RmxhZzp7THkzMTkuaTVkMWYqaUN1bHQhfQ==</p>
</blockquote>

<p>解码得到flag：Flag:{Ly319.i5d1f*iCult!}</p>

<h2 id="0x06-basic-09">0x06 Basic-09</h2>

<p>题目：大黑阔在某数据库中提取到了管理员的密码，但是密码是加密的，本要放弃的黑阔突然发现加密竟然是可逆的，网页上的脚本被黑阔提取出来了，你能够帮助黑阔解密吗？黑阔感激不尽。加密数据：fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA=</p>

<p>题目提供了加密脚本</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span></span><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">encrypt</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span><span class="nv">$key</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$key</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="s1">&#39;ISCC&#39;</span><span class="p">);</span>
    <span class="nv">$x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nv">$len</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
    <span class="nv">$klen</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$key</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$len</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
        <span class="k">if</span> <span class="p">(</span><span class="nv">$x</span> <span class="o">==</span> <span class="nv">$klen</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nv">$x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nv">$char</span> <span class="o">.=</span> <span class="nv">$key</span><span class="p">[</span><span class="nv">$x</span><span class="p">];</span>
        <span class="nv">$x</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$len</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$str</span> <span class="o">.=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$data</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$char</span><span class="p">[</span><span class="nv">$i</span><span class="p">]))</span> <span class="o">%</span> <span class="mi">128</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span></code></pre></figure>

<p>根据加密过程逆向写出poc脚本</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="lineno"> 1 </span><span class="kn">import</span> <span class="nn">md5</span><span class="o">,</span> <span class="nn">base64</span>
<span class="lineno"> 2 </span><span class="n">key</span> <span class="o">=</span> <span class="n">md5</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="s1">&#39;ISCC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="lineno"> 3 </span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="lineno"> 4 </span><span class="n">kl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="lineno"> 5 </span><span class="n">c_txt</span> <span class="o">=</span> <span class="s2">&quot;fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA=&quot;</span>
<span class="lineno"> 6 </span><span class="n">m_txt</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">c_txt</span><span class="p">)</span>
<span class="lineno"> 7 </span><span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m_txt</span><span class="p">)</span>
<span class="lineno"> 8 </span><span class="n">m_l</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno"> 9 </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">m_txt</span><span class="p">:</span>
<span class="lineno">10 </span>	<span class="n">m_l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="lineno">11 </span>
<span class="lineno">12 </span><span class="n">char_l</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno">13 </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">38</span><span class="p">):</span>
<span class="lineno">14 </span>	<span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">kl</span><span class="p">:</span>
<span class="lineno">15 </span>		<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="lineno">16 </span>	<span class="n">char_l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span>
<span class="lineno">17 </span>	<span class="n">x</span><span class="o">+=</span><span class="mi">1</span>
<span class="lineno">18 </span><span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="lineno">19 </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">38</span><span class="p">):</span>
<span class="lineno">20 </span>	<span class="k">if</span> <span class="n">m_l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">char_l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="lineno">21 </span>		<span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">m_l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">128</span><span class="o">-</span><span class="n">char_l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="lineno">22 </span>	<span class="k">else</span><span class="p">:</span>
<span class="lineno">23 </span>		<span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">m_l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">char_l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="lineno">24 </span>
<span class="lineno">25 </span><span class="k">print</span> <span class="n">result</span></code></pre></figure>

<h2 id="0x07-misc-02">0x07 Misc-02</h2>

<p>题目：眼见非实</p>

<p>题目文件是一个word文档，打开后显示文件损坏，内容全都是乱码，修改后缀为zip解压，得到一堆xml文件，挨个文件搜索flag</p>

<p>在word/document.xml中找到flag：flag{F1@g}</p>

<p><img src="/images/iscc-2017-wp/10.jpg" alt="flag" /></p>

<h2 id="0x08-misc-03">0x08 Misc-03</h2>

<p>题目：啊。我好像捕获到了什么不得了的东西。</p>

<p>题目文件是一个抓包流量，以ftp协议为主，从中拿到了四个文件，有rsa公钥&amp;私钥，key.zip和一个pdf文档，把文件提取出来之后开始解密</p>

<blockquote>
  <pre><code> openssl rsautl -decrypt -in key.txt -inkey test.key -out 1.txt
</code></pre>
</blockquote>

<p><img src="/images/iscc-2017-wp/11.jpg" alt="openssl解密" /></p>

<p>flag is {haPPy_Use_0penSsI}</p>

<h2 id="0x09-web-02">0x09 Web-02</h2>

<p>忘记保存网页代码了= =#b</p>

<p>最终构造payload：index.php?iscc={“bar1”:”2017a”,”bar2”:[[],0,””,””,””]}&amp;cat[]=aisccctf2017&amp;cat[][]=1&amp;cat[][]=2&amp;dog=%00</p>

<p>flag: flag{sfklljljdstuaft}</p>

<h2 id="0x0a-mobile-01">0x0A Mobile-01</h2>

<p>用jadx检查源码发现程序读取用户输入后调用so进行比较</p>

<p><img src="/images/iscc-2017-wp/12.jpg" alt="jadx" /></p>

<p>用ida查看so库的伪代码，发现native_checkFlag函数对未加密字符串前半段+5，然后翻转，最后和密文比较</p>

<p><img src="/images/iscc-2017-wp/13.jpg" alt="ida" /></p>

<p>poc脚本，flag：flag{ISCCJAVANDKYXX}</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="lineno"> 1 </span><span class="n">cyper</span> <span class="o">=</span> <span class="s2">&quot;=0HWYl1SE5UQWFfN?I+PEo.UcshU&quot;</span>
<span class="lineno"> 2 </span>
<span class="lineno"> 3 </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cyper</span><span class="p">)):</span>
<span class="lineno"> 4 </span>    <span class="n">str1</span> <span class="o">=</span> <span class="n">cyper</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
<span class="lineno"> 5 </span>    <span class="n">str2</span> <span class="o">=</span> <span class="n">cyper</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
<span class="lineno"> 6 </span>    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="lineno"> 7 </span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">str2</span><span class="p">:</span>
<span class="lineno"> 8 </span>        <span class="n">s</span><span class="o">+=</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<span class="lineno"> 9 </span>    <span class="n">s</span> <span class="o">=</span> <span class="n">str1</span><span class="o">+</span><span class="n">s</span>
<span class="lineno">10 </span>    <span class="n">l</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="lineno">11 </span>    <span class="n">l</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="lineno">12 </span>    <span class="n">r</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="lineno">13 </span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
<span class="lineno">14 </span>        <span class="n">r</span> <span class="o">+=</span> <span class="n">j</span>
<span class="lineno">15 </span>    <span class="k">print</span> <span class="n">r</span></code></pre></figure>

<h2 id="0x0b-reverse-01">0x0B Reverse-01</h2>

<p><img src="/images/iscc-2017-wp/14.jpg" alt="ida" /></p>

<p>根据输出信息不难看出，正确的分支是左侧的一支，test为检验函数</p>

<p><img src="/images/iscc-2017-wp/15.jpg" alt="ida" /></p>

<p>检验过字符串长度后逐字符检验，不难得出结果flag{1t.is.5O.easy}</p>

<h2 id="0x0c-reverse-02">0x0C Reverse-02</h2>

<p>找到正确分支为中间，可以从中找到两个检验函数sub_400646和sub_400755</p>

<p><img src="/images/iscc-2017-wp/16.jpg" alt="ida" /></p>

<p>检验算法伪代码如下，均为逐字符检验，不难还原，最后拼接出结果Flag: flag{l1nux_crack_ILCF!}</p>

<p><img src="/images/iscc-2017-wp/18.jpg" alt="sub_400646" /></p>

<p><img src="/images/iscc-2017-wp/17.jpg" alt="sub_400755" /></p>

<h2 id="0x0d-reverse-03">0x0D Reverse-03</h2>

<p>主函数很短，从中找到下一步调用sub_400796和sub_400937 (当时这里的随机数中困扰了我很久，赛后看到dalao的wp，发现unsigned int只有四位，也就是输入的前四位才是随机数种子，根据格式前四位就是flag，可以从这里推出伪随机的字符)</p>

<p><img src="/images/iscc-2017-wp/19.jpg" alt="ida" /></p>

<p>第一步是生成一个供第二步用的编码表</p>

<p><img src="/images/iscc-2017-wp/20.jpg" alt="sub_400796" /></p>

<p>第二步根据{_}进行分割，一个简单的栅栏加密</p>

<p><img src="/images/iscc-2017-wp/21.jpg" alt="sub_400937" /></p>

<p>程序分析完毕，写出对应的poc脚本，题目刚出时我下载的文件，后来做出来时怎么提交都不对，和队友交流之后发现我的密文和他的不一样？？？(黑人问号脸.jpg）大概是主办方换了flag？？吐槽一下也没有通知就换flag，重新下载题目文件才通过。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="lineno"> 1 </span><span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno"> 2 </span><span class="n">ll</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">]</span>
<span class="lineno"> 3 </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">26</span><span class="p">):</span>
<span class="lineno"> 4 </span>	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">26</span><span class="p">):</span>
<span class="lineno"> 5 </span>		<span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span><span class="o">+</span><span class="mi">97</span><span class="p">)</span>
<span class="lineno"> 6 </span><span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="lineno"> 7 </span><span class="n">c_txt</span> <span class="o">=</span> <span class="s2">&quot;vhex{bykfnpl_lgtn_tr_xzsl_lavp_ghbsgekwntn}&quot;</span>
<span class="lineno"> 8 </span><span class="n">dic</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="lineno"> 9 </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span> <span class="mi">123</span><span class="p">):</span>
<span class="lineno">10 </span>	<span class="n">dic</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="lineno">11 </span><span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="lineno">12 </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">c_txt</span><span class="p">)):</span>
<span class="lineno">13 </span>	<span class="k">if</span> <span class="n">c_txt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;_&quot;</span><span class="p">:</span>
<span class="lineno">14 </span>		<span class="n">txt</span> <span class="o">+=</span> <span class="s2">&quot;_&quot;</span>
<span class="lineno">15 </span>		<span class="k">print</span> <span class="s2">&quot;_&quot;</span>
<span class="lineno">16 </span>		<span class="k">continue</span>
<span class="lineno">17 </span>	<span class="k">if</span> <span class="n">c_txt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;{&quot;</span><span class="p">:</span>
<span class="lineno">18 </span>		<span class="n">txt</span> <span class="o">+=</span> <span class="s2">&quot;{&quot;</span>
<span class="lineno">19 </span>		<span class="k">print</span> <span class="s2">&quot;{&quot;</span>
<span class="lineno">20 </span>		<span class="k">continue</span>
<span class="lineno">21 </span>	<span class="k">if</span> <span class="n">c_txt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;}&quot;</span><span class="p">:</span>
<span class="lineno">22 </span>		<span class="n">txt</span> <span class="o">+=</span> <span class="s2">&quot;}&quot;</span>
<span class="lineno">23 </span>		<span class="k">print</span> <span class="s2">&quot;}&quot;</span>
<span class="lineno">24 </span>		<span class="k">continue</span>
<span class="lineno">25 </span>	<span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span>
<span class="lineno">26 </span>		<span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">26</span><span class="o">*</span><span class="p">((</span><span class="nb">ord</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span><span class="o">-</span><span class="mi">97</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">ll</span><span class="p">[</span><span class="n">k</span><span class="o">%</span><span class="mi">26</span><span class="p">]</span><span class="o">-</span><span class="mi">97</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span><span class="p">]</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c_txt</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
<span class="lineno">27 </span>			<span class="n">txt</span> <span class="o">+=</span> <span class="n">ch</span>
<span class="lineno">28 </span>			<span class="k">print</span> <span class="n">ch</span><span class="p">,</span> 
<span class="lineno">29 </span>	<span class="k">print</span> <span class="s2">&quot;&quot;</span>
<span class="lineno">30 </span><span class="k">print</span> <span class="n">txt</span></code></pre></figure>

<p>flag：flag{decrypt_game_is_very_very_interesting}</p>

<p>附：<a href="http://www.freebuf.com/articles/others-articles/135825.html">Freebuf China H.L.B战队完整WriteUp</a></p>

        <div id="disqus_thread"></div>
		<script type="text/javascript">
		    /* * * CONFIGURATION VARIABLES * * */
		    var disqus_shortname = 'albus12138';
		    
		    /* * * DON'T EDIT BELOW THIS LINE * * */
		    (function() {
		        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		    })();
		</script>
		<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    </div>

    <div class="sidenav">
        <h2>Blog</h2>
        <ul class="artical-list">
        
        
            
            <li><a href="/blog/why-blog">我为什么写博客？</a></li>
            
            
        
        </ul>

        <h2>Coding</h2>
        <ul class="artical-list">
        
        
            
            <li><a href="/coding/python-re">Python正则表达式</a></li>
            
            
        
            
            <li><a href="/coding/xctf-carnival-wp">XCTF嘉年华体验赛 Re部分WriteUp</a></li>
            
            
        
            
            <li><a href="/coding/gctf-wp">GCTF Re&Mobile WriteUp</a></li>
            
            
        
            
            <li><a href="/coding/python-requests">Requests模块</a></li>
            
            
        
            
            <li><a href="/coding/iscc-2017-wp">ISCC2017 WriteUp</a></li>
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
        </ul>

        <h2>Bookmarks</h2>
        <ul class="artical-list">
        
        
            
            <li><a href="/bookmarks/ddos">免费DDOS攻击测试工具</a></li>
            
            
        
            
            <li><a href="/bookmarks/network-traffic-hijacking-2">网络流量攻击的危害</a></li>
            
            
        
            
            <li><a href="/bookmarks/network-traffic-hijacking">网络流量攻击</a></li>
            
            
        
            
            <li><a href="/bookmarks/resouces-for-learn-python">学习Python编程的11个资源</a></li>
            
            
        
            
            <li><a href="/bookmarks/buffer-overflow">缓冲区溢出攻击相关知识</a></li>
            
            
        
        </ul>
    </div>
</div>

<script src="/js/post.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(function(){
            $('.home-follow').click(function(e){
                e.preventDefault();
            });
        })
        $(document).ready(function(){
            var id = Math.floor(Math.random()*5)+1;
            $(".aside").css("background-image","url(/images/bg-"+id+".jpg)");            
        })
    </script>
</body>
</html>
